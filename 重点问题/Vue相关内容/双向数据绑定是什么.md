# 双向数据绑定是什么

## 什么是双向绑定

先从单向绑定切入单向绑定非常简单，就是把 Model 绑定到 View，当我们用 JavaScript 代码更新 Model 时，View 就会自动更新

双向绑定就很容易联想到了，在单向绑定的基础上，用户更新了 View，Model 的数据也自动被更新了，这种情况就是双向绑定

## 双向绑定的原理是什么

Vue 是数据双向绑定的框架，双向绑定由三个重要部分构成

- 数据层 Model，应用的数据及业务逻辑
- 视图层 View，应用的展示效果，各类 UI 组件
- 业务逻辑层 ViewModel，框架封装的核心，负责将数据与视图关联起来

### 理解 ViewModel 的作用

- 数据变化后更新视图
- 视图变化后更新数据

由两个部分组成

- 监听器 （Observer）: 对所有数据的属性监听，当数据发生变化时，通知 ViewModel
- 解析器 (Compiler)：对每个元素节点的指令进行解析，根据指令模板替换数据，以及绑定相应的更新函数

### 实现双向绑定

- new Vue()首先执行初始化，对 data 执行响应化处理，这个过程发生 Observe 中
- 同时对模板执行编译，找到其中动态绑定的数据，从 data 中获取并初始化视图，这个过程发生在 Compile 中
- 同时定义一个更新函数和 Watcher ，将来对应数据变化时 Watcher 会调用更新函数
- 由于 data 的某个 key 在一个视图中可能出现多次，所以每个 key 都需要一个管家 Dep 来管理多个 Watcher
- 将来 data 中数据一旦发生变化，会首先找到对应的 Dep，通知所有 Watcher 执行更新函数
