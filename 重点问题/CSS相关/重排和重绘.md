# 重排和重绘

在浏览器渲染的过程中，重排（Reflow）和重绘（Repainting）是两个紧密相关但又有所区别的概念

`重排一定会重绘，重绘不一定会重排`

当浏览器需要进行重排时，它会重新计算元素的位置和尺寸，并更新渲染树。一旦渲染树被更新，浏览器就需要重新绘制受影响的元素。因此，重排必然会导致重绘

重绘是指浏览器重新绘制元素的视觉属性，如颜色、背景等。如果这些改变不影响元素的位置或尺寸，就不会触发重排。换句话说，重绘可以在不改变布局的情况下进行

## 重绘

重绘通常只涉及视觉样式的改变，如颜色、背景等，不涉及布局的重新计算。因此，重绘的性能开销较小

通常由以下情况触发

- 改变元素的颜色、背景颜色、边框颜色等
- 改变元素的透明度（opacity）
- 改变元素的轮廓（outline）
- 改变元素的可见性（visibility）

## 重排

重排涉及页面元素的布局调整，需要重新计算渲染树，这通常会引起重绘。因此，重排的性能开销较大

通常由以下情况触发

- 改变元素的高度、宽度
- 改变元素的内边距（padding）、外边距（margin）
- 改变元素的显示状态（display）
- 改变元素的位置（position）
- 改变元素的字体大小（font-size）

## 优化建议

- 减少重排：尽量减少对元素尺寸和位置的修改，特别是频繁的操作
- 批量修改：将多个 DOM 修改操作放在一个批处理中，减少重排次数
- 使用 CSS 变换：使用 CSS 变换（如 transform）代替 DOM 变更，减少布局计算的成本
- 使用 requestAnimationFrame：在动画过程中使用 requestAnimationFrame 来调用 getBoundingClientRect 或其他涉及布局的操作，确保在每一帧开始时获取最新的布局信息
