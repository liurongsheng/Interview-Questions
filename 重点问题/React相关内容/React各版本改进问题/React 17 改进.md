# React 17 改进

React 17 相比 React 16 的主要更新集中在底层架构的变化，目的是为了更好地兼容未来的 React 特性，特别是那些在 React 18 中引入的。

以下是 React 17 相对于 React 16 的一些重要变化：

## 事件代理的更改

- React 17 改变了事件代理的实现方式，从之前在 document 对象上监听事件变为在每个 React 应用的 rootNode 节点上绑定事件处理器。这一改动有助于解决多个版本的 React 应用在同一页面中共存时可能出现的问题
- onScroll 事件不再冒泡，这可以避免一些常见的问题。

## 新的 JSX 转换

React 17 引入了新的 JSX 转换规则，虽然对于大多数开发者来说这不会直接影响到他们的代码编写方式，但这为未来的 React 版本提供了更好的支持

## 事件池(event pooling)的改变

在 React 17 中，事件池机制被移除，因此不再需要调用 e.persist() 来保留事件对象。现在可以在异步回调中直接访问事件对象，使得事件处理逻辑更加直观

## 异步执行

React 17 使副作用清理函数（如 componentWillUnmount 或 useEffect 的清理函数）在浏览器完成渲染之后异步执行

## forwardRef 和 memo 组件行为一致化

在 React 17 中，forwardRef 和 memo 包装的组件在某些情况下（例如返回 undefined 时）的行为与普通的函数组件和类组件保持一致

总的来说，React 17 的目标主要是为了简化框架内部结构，为未来版本的功能铺平道路，而不是引入许多面向用户的显著新特性。这意味着对于大多数应用程序来说，React 16 到 React 17 的迁移应该相对平滑，不会涉及到大量的代码更改
