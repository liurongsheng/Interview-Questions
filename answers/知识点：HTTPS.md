# 知识点：HTTPS

HTTP协议过于简单：

- 通信使用明文（不加密），内容可能会被窃听
- 不验证通信方的身份，因此可能遭遇伪装
- 无法验证报文的完整性，所以有可能已遭篡改

## HTTPS 实质

HTTP 加上加密处理、认证机制、以及完整性保护后的就是HTTPS

HTTP 通信接口部分用 SSL 或 TLS 协议代替而已。其实就是身披 SSL 协议外壳的 HTTP
```
应用 HTTP
SSL(区分)
TCP
IP
```

SSL 和 TLS
HTTPS 中使用了 SSL 和 TLS 这两个协议

TLS以SSL3.0为基准，后又制定了TLS1.0、TLS1.1和TLS1.2

当前主流的版本是SSL3.0和TLS1.0

TLS是以SSL为原型开发的协议，有时候会统称该协议为SSL

## 非对称加密技术和对称加密技术

对称加密算法

采用单钥密码系统的加密方式，同一个密钥可以同时做信息的加密和解密，这种加密的方法称为对称加密，也称为单密钥加密

SSL在通信过程中，如果使用了对称加密算法，也就是说客户端和服务器同时共享一个密钥

于是，以共享密钥的方式加密，必须将密钥发给对方。这个时候，假如通信过程被监听，密钥被攻击者获取了，那么这个时候也就失去了加密的意义了

非对称加密算法

与对称加密算法相反，非对称加密算法需要两个密钥来进行加密和解密，这两个密钥是配对的，分别是公开密钥（公钥）和私有密钥（私钥）。


当客户端第一次发请求和服务器协商的时候，服务器就生成了一对公钥和私钥。

紧接着，服务器把公钥发给客户端（明文，不需要做任何加密），客户端接收后，随机生成一个密钥，使用服务器发过来的公钥进行加密。

再接着，客户端把使用公钥加密的密钥发给服务器，服务器接收到了以后，用配对的私钥进行解密，就得到了客户端随机生成的那个密钥。

这个时候，客户端和服务端所持的密钥都是相同的。此时，交换密钥环节就完成了。

于是通信开始时就可进行上面所述的共享密钥加密方式来进行加密。

### 同时使用

可能，有小伙伴就会问，为什么要大费周章使用非对称加密的方式，然后再得到相同的密钥，进行共享密钥加密的通信呢？

由于公开密钥加密处理起来比共享密钥加密方式更为复杂，因此在通信的时候使用公开密钥加密的方式，效率很低。

于是，我们需要使用非对称加密的方式来保证密钥共享的过程中密钥的安全性，而后在通信的过程中使用对称加密算法，这是最合理的设计方式，

在保证安全性的同时又保证了性能。

所以，HTTPS采用共享密钥加密和公开密钥加密两者并用的混合加密机制。在交换密钥使用环节使用公开密钥加密方式，

之后建立的通信交换报文阶段则使用共享密钥加密方式。

以上，大概就是使用对称加密和非对称加密的过程。看似过程很完美，其实还存在着一个问题，就是：如何保证服务器传过来的公开密钥的正确性。

换句话说，就是保证它不被拦截篡改。

### 使用证书保证公钥的正确性

假如现在正准备和某台服务器建立公开密钥加密方式下的通信，如何证明客户端收到的公开密钥就是原本预想的那台服务器发行的公开密钥呢？

或许，在公开密钥传输的过程中，真正的公开密钥可能已经被攻击者替换掉了。

为了解决这个问题，可以使用由数字证书机构和其相关颁发的公开密钥证书。


https://segmentfault.com/a/1190000012196642
